from base64 import *

'''-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDAp1ORv2zwu8Ry
vCeykrJ/17WrVDJyVIX/eWrvfNRyS/32944xl7Uvtyv6iRKkHA0+R66ugdP/1T9s
XnMCldVJVApvR1aZ/2KIwoqW8mfpJLC+9QJAkSP9o7ClA+xAM5zHrvBvmM4XV9DV
ujewuwAdNSVc+BjE+MicHoN2Vmx0ushROiWnUs1SCOpRTyPdaeAC0+UFOSSazfPB
rx6yzWL6Ei7otdE7oxPnOVvN/EpcqdIc2N/W/DqOJ5F/52dCEhXhq5ztq+E0s71V
xbAE/w09PiEUkO4C+GffRx7j5LLtRCFIedGJ+xv4oK/sAYJr3OSgb/1fzCU0KXkU
OHHpqbyHAgMBAAECggEAOxbXTfu9qTSeM2a8ckwGTanWwb7oXiLImqwd/Wh3LLtc
INSbG2DhpMn0xjomqokkErcfv8x4Pp6kflOVyPQ13/DT5n+l80Peb/3jThr5fgvP
3jH9x9n8hP4g3uwOGT77Vk+01TWz+HrpxbQBAsbIaSz00cgSqM95kFDXl4M4brCV
2kLjbk7RFABHXecg39YmHP/HfweWp3iCTW1/6H/aFHjxSUOs3aew2zu43pGOlFg1
IXU11lClFeIchkYGoPpoUwHFsKDaRjQSXRIqahlXJ2CLaXe8+Oa49DFOoFGAOQND
41XdipS/55O2PvXIM/kefqa7BP9ep9GdNZZrLtBYWQKBgQDBcfcsf2F1h6ZX4lhA
s3kjodCfH25v3K1pt/krPOQ716zoq3Prh1PzTZrynLoLl727r0nLczDWg42UyoUY
yMNbmu76MBhF5qU6paeOLfFizTraihsT6e0k/cTUw2/L/5qce7L+FGJ8OTIuCI1Q
iZO72tpKU9diisTyxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxx
-----END PRIVATE KEY-----'''

key = b64decode('''MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDAp1ORv2zwu8Ry
vCeykrJ/17WrVDJyVIX/eWrvfNRyS/32944xl7Uvtyv6iRKkHA0+R66ugdP/1T9s
XnMCldVJVApvR1aZ/2KIwoqW8mfpJLC+9QJAkSP9o7ClA+xAM5zHrvBvmM4XV9DV
ujewuwAdNSVc+BjE+MicHoN2Vmx0ushROiWnUs1SCOpRTyPdaeAC0+UFOSSazfPB
rx6yzWL6Ei7otdE7oxPnOVvN/EpcqdIc2N/W/DqOJ5F/52dCEhXhq5ztq+E0s71V
xbAE/w09PiEUkO4C+GffRx7j5LLtRCFIedGJ+xv4oK/sAYJr3OSgb/1fzCU0KXkU
OHHpqbyHAgMBAAECggEAOxbXTfu9qTSeM2a8ckwGTanWwb7oXiLImqwd/Wh3LLtc
INSbG2DhpMn0xjomqokkErcfv8x4Pp6kflOVyPQ13/DT5n+l80Peb/3jThr5fgvP
3jH9x9n8hP4g3uwOGT77Vk+01TWz+HrpxbQBAsbIaSz00cgSqM95kFDXl4M4brCV
2kLjbk7RFABHXecg39YmHP/HfweWp3iCTW1/6H/aFHjxSUOs3aew2zu43pGOlFg1
IXU11lClFeIchkYGoPpoUwHFsKDaRjQSXRIqahlXJ2CLaXe8+Oa49DFOoFGAOQND
41XdipS/55O2PvXIM/kefqa7BP9ep9GdNZZrLtBYWQKBgQDBcfcsf2F1h6ZX4lhA
s3kjodCfH25v3K1pt/krPOQ716zoq3Prh1PzTZrynLoLl727r0nLczDWg42UyoUY
yMNbmu76MBhF5qU6paeOLfFizTraihsT6e0k/cTUw2/L/5qce7L+FGJ8OTIuCI1Q
iZO72tpKU9diisTy''').hex()
#print(key)
'''308204bf020100300d06092a864886f70d0101010500048204a9308204a50
201000282010100c0a75391bf6cf0bbc472bc27b292b27fd7b5ab5432725485ff
796aef7cd4724bfdf6f78e3197b52fb72bfa8912a41c0d3e47aeae81d3ffd53f6
c5e730295d549540a6f475699ff6288c28a96f267e924b0bef502409123fda3b0
a503ec40339cc7aef06f98ce1757d0d5ba37b0bb001d35255cf818c4f8c89c1e8
376566c74bac8513a25a752cd5208ea514f23dd69e002d3e50539249acdf3c1af
1eb2cd62fa122ee8b5d13ba313e7395bcdfc4a5ca9d21cd8dfd6fc3a8e27917fe
767421215e1ab9cedabe134b3bd55c5b004ff0d3d3e211490ee02f867df471ee3
e4b2ed44214879d189fb1bf8a0afec01826bdce4a06ffd5fcc25342979143871e
9a9bc870203010001028201003b16d74dfbbda9349e3366bc724c064da9d6c1be
e85e22c89aac1dfd68772cbb5c20d49b1b60e1a4c9f4c63a26aa892412b71fbfc
c783e9ea47e5395c8f435dff0d3e67fa5f343de6ffde34e1af97e0bcfde31fdc7
d9fc84fe20deec0e193efb564fb4d535b3f87ae9c5b40102c6c8692cf4d1c812a
8cf799050d79783386eb095da42e36e4ed11400475de720dfd6261cffc77f0796
a778824d6d7fe87fda1478f14943acdda7b0db3bb8de918e945835217535d650a
515e21c864606a0fa685301c5b0a0da4634125d122a6a195727608b6977bcf8e6
b8f4314ea05180390343e355dd8a94bfe793b63ef5c833f91e7ea6bb04ff5ea7d
19d35966b2ed0585902818100c171f72c7f617587a657e25840b37923a1d09f1f
6e6fdcad69b7f92b3ce43bd7ace8ab73eb8753f34d9af29cba0b97bdbbaf49cb7
330d6838d94ca8518c8c35b9aeefa301845e6a53aa5a78e2df162cd3ada8a1b13
e9ed24fdc4d4c36fcbff9a9c7bb2fe14627c39322e088d508993bbdada4a53d76
28ac4f2'''

# sequence 308204bf020100300d06092a864886f70d0101010500048204a9308204a5020100
# 028201
# 01
# n 00c0a75391bf6cf0bbc472bc27b292b27fd7b5ab5432725485ff796aef7cd4724bfdf6f78e3197b52fb72bfa8912a41c0d3e47aeae81d3ffd53f6c5e730295d549540a6f475699ff6288c28a96f267e924b0bef502409123fda3b0a503ec40339cc7aef06f98ce1757d0d5ba37b0bb001d35255cf818c4f8c89c1e8376566c74bac8513a25a752cd5208ea514f23dd69e002d3e50539249acdf3c1af1eb2cd62fa122ee8b5d13ba313e7395bcdfc4a5ca9d21cd8dfd6fc3a8e27917fe767421215e1ab9cedabe134b3bd55c5b004ff0d3d3e211490ee02f867df471ee3e4b2ed44214879d189fb1bf8a0afec01826bdce4a06ffd5fcc25342979143871e9a9bc87
# 02
# 03
# e 010001
# 028201
# d 003b16d74dfbbda9349e3366bc724c064da9d6c1bee85e22c89aac1dfd68772cbb5c20d49b1b60e1a4c9f4c63a26aa892412b71fbfcc783e9ea47e5395c8f435dff0d3e67fa5f343de6ffde34e1af97e0bcfde31fdc7d9fc84fe20deec0e193efb564fb4d535b3f87ae9c5b40102c6c8692cf4d1c812a8cf799050d79783386eb095da42e36e4ed11400475de720dfd6261cffc77f0796a778824d6d7fe87fda1478f14943acdda7b0db3bb8de918e945835217535d650a515e21c864606a0fa685301c5b0a0da4634125d122a6a195727608b6977bcf8e6b8f4314ea05180390343e355dd8a94bfe793b63ef5c833f91e7ea6bb04ff5ea7d19d35966b2ed05859
# 028181
# not completed	 00c171f72c7f617587a657e25840b37923a1d09f1f6e6fdcad69b7f92b3ce43bd7ace8ab73eb8753f34d9af29cba0b97bdbbaf49cb7330d6838d94ca8518c8c35b9aeefa301845e6a53aa5a78e2df162cd3ada8a1b13e9ed24fdc4d4c36fcbff9a9c7bb2fe14627c39322e088d508993bbdada4a53d7628ac4f2

n = 0x00c0a75391bf6cf0bbc472bc27b292b27fd7b5ab5432725485ff796aef7cd4724bfdf6f78e3197b52fb72bfa8912a41c0d3e47aeae81d3ffd53f6c5e730295d549540a6f475699ff6288c28a96f267e924b0bef502409123fda3b0a503ec40339cc7aef06f98ce1757d0d5ba37b0bb001d35255cf818c4f8c89c1e8376566c74bac8513a25a752cd5208ea514f23dd69e002d3e50539249acdf3c1af1eb2cd62fa122ee8b5d13ba313e7395bcdfc4a5ca9d21cd8dfd6fc3a8e27917fe767421215e1ab9cedabe134b3bd55c5b004ff0d3d3e211490ee02f867df471ee3e4b2ed44214879d189fb1bf8a0afec01826bdce4a06ffd5fcc25342979143871e9a9bc87
e = 0x10001
d = 0x003b16d74dfbbda9349e3366bc724c064da9d6c1bee85e22c89aac1dfd68772cbb5c20d49b1b60e1a4c9f4c63a26aa892412b71fbfcc783e9ea47e5395c8f435dff0d3e67fa5f343de6ffde34e1af97e0bcfde31fdc7d9fc84fe20deec0e193efb564fb4d535b3f87ae9c5b40102c6c8692cf4d1c812a8cf799050d79783386eb095da42e36e4ed11400475de720dfd6261cffc77f0796a778824d6d7fe87fda1478f14943acdda7b0db3bb8de918e945835217535d650a515e21c864606a0fa685301c5b0a0da4634125d122a6a195727608b6977bcf8e6b8f4314ea05180390343e355dd8a94bfe793b63ef5c833f91e7ea6bb04ff5ea7d19d35966b2ed05859

from Crypto.Util.number import *
c = bytes_to_long(open('../dist/flag.enc','rb').read())
m = long_to_bytes(pow(c,d,n))
print(m[m.rfind(b'\x00'):])
