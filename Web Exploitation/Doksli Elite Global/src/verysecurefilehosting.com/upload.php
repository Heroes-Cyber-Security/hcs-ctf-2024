<?php

if ($_SERVER['REQUEST_METHOD'] !== 'POST') {
    header('Location: upload.html');
    exit();
}

if (!isset($_FILES['file'])) {
    die('No file uploaded!');
}

if ($_FILES["file"]["size"] > 500000) {
    die("Sorry, your file is too large. Maximal file size is 500KB.");
}

$target_dir = 'storage/';

$target_file = $target_dir . uniqid() . basename($_FILES['file']['name']);

if (move_uploaded_file($_FILES['file']['tmp_name'], $target_file)) {
    header('Location: access.php?file=' . basename($target_file));
} else {
    echo 'Sorry, there was an error uploading your file.';
}
